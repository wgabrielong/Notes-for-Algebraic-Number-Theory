\section{Lecture 2 -- 13th September 2023}
Let us begin by recalling some facts about integrality. 
\begin{definition}[Integral Domain]
  A ring $A$ is an integral domain if it has no zerodivisors, that is, there do not exist $a,b\in A\setminus\{0\}$ such that $ab=0$. 
\end{definition}
\begin{definition}[Integral Over]
  Let $A,B$ be rings and $A\subseteq B$. An element $x\in B$ is integral over $A$ if it is the root of some monic polynomial with coefficients in $A$. The ring $B$ is integral over $A$ if all its elements are integral over $A$. 
\end{definition}
\begin{definition}[Integrally Closed]
  A ring $A$ is integrally closed if all elements of the fraction field $K(A)$ are integral over $A$. 
\end{definition}
Let us consider some examples. 
\begin{example}
  $\ZZ$ is integrally closed. This is the content of Gauss' lemma. 
\end{example}
\begin{example}
  Let $K$ be a number field and $\Ocal_{K}$ be its ring of integers. $\Ocal_{K}$ is integrally closed. 
\end{example}
In fact, we can show that DVRs are also integrally closed. To do so, we first show the follwing lemma. 
\begin{lemma}
  Let $A$ be a DVR with fraction field $K(A)$. If $x_{1},\dots,x_{n}\in K(A)$ are such that $v(x_{i})>v(x_{1})$ for all $i\geq 2$, then $x_{1}+\dots+x_{n}\neq0$. 
\end{lemma}
\begin{proof}
  Suppose to the contrary $x_{1}+\dots+x_{n}=0$. Equivalently $x_{2}+\dots+x_{n}=-x_{1}$ and applying the valuation we see that $v(x_{2}+\dots+x_{n})\geq\min\{v(x_{2}),\dots,v(x_{n})\}>v(x_{1})=v(-x_{1})$ a contradiction since $v(x_{2}+\dots+x_{n})\neq v(x_{1})=v(-x_{1})$. 
\end{proof}
We can now show the desired fact. 
\begin{proposition}[DVRs Integrally Closed]\label{prop:DVR integrally closed}
  A DVR $A$ is integrally closed. 
\end{proposition}
\begin{proof}
Let $x\in K(A)$ such that it satisfies the monic polynomial in $A$
$$x^{n}+a_{n-1}x^{n-1}+\dots+a_{1}x+a_{0}=0.$$
We seek to show $x\in A$, that is, $v(x)\geq0$. Suppose to the contrary that $v(x)=-m$ for some $m>0$. Applying the discrete valuation on $A$ to the polynomial, we have $v(x^{n})=-mn$ and each of the latter summands have valuations at least $-(n-1)m>-nm=v(x^{n})$ since each of the $a_{i}$ have non-negative discrete valuations. Applying the lemma above, $x$ cannot be the root of the polynomial, giving a contradiction and showing that $v(x)\geq0$ as desired. 
\end{proof}
More explicitly, we can show that the condition in \Cref{prop:DVR integrally closed} in conjunction with the condition of having a unique nonzero prime ideal to characterize DVRs. 
\begin{proposition}\label{prop:DVR iff integrally closed and unique nonzero prime}
  A Noetherian integral domain $A$ is a DVR if and only if it is integrally closed and has a unique nonzero prime ideal. 
\end{proposition}
\begin{proof}
  See \cite[Ch. 1, \S 2, Prop. 3]{Serre}. 
\end{proof}
Let us narrow our focus to Dededekind domains and understand these through the lens of DVRs. To do this, we will first have to define localization. 
\begin{definition}[Localization]
  Let $A$ be an integral domain and $K(A)$ its fraction field. Let $S\subseteq A$ be a multiplicatively closed subset of $A$ containing 1. We define the localization of $A$ away from $S$ as the set 
  $$S^{-1}A=\left\{\frac{a}{s}|a\in A, s\in S\right\}$$
  under the operations of addition and multiplication.
\end{definition}
\begin{example}
  Let $S=A\setminus\{0\}$ then $S^{-1}A=K(A)$, the fraction field of $A$. 
\end{example}
\begin{example}
  Let $S=A^{\times}$ then $S^{-1}A=A$. 
\end{example}
The prime ideals in $A$ and $S^{-1}A$ are closely related in the following way: the prime ideals in $S^{-1}A$ are those prime ideals in $A$ not intersecting $S$. 
\begin{proposition}\label{prop:localization correspondence}
  There is a bijection between prime ideals of $A$ and $S^{-1}A$ sending a prime ideal $\wp\subseteq A$ to $S^{-1}\wp=\{\frac{p}{s}|p\in\wp,s\in S\}$ and conversely sending $\wp\subseteq S^{-1}A$ to $\wp\cap A$. 
\end{proposition}
\begin{proof}
  Let $\wp$ be a prime ideal of $A$ not intersecting $S$ and consider $\frac{ab}{s_{1}s_{2}}\in S^{-1}\wp$ where $a,b\in A, s_{1},s_{2}\in S$. There is $\frac{c}{s}\in S^{-1}\wp$ such that $\frac{ab}{s_{1}s_{2}}=\frac{c}{s}$ or equivalently that for some $t\in S$, we have $t(abs-cs_{1}s_{2})=0$ where $abst = cs_{1}s_{2}t$ and $abst\in\wp$. Noting $st\in S$ with $S$ multiplicatively closed and $S\cap\wp=\emptyset$ $ab\in\wp$ since $\wp$ is prime in $A$ and one of $a,b$ is in $\wp$. So one of $\frac{a}{s_{1}},\frac{b}{s_{2}}\in S^{-1}\wp$. One can also see by definition of $S^{-1}\wp=\{\frac{p}{s}|p\in\wp,s\in S\}$ that $S^{-1}\wp\cap A=\wp$. 
  \\\\
  Let $\overline{\wp}$ be a prime ideal in $S^{-1}A$. Under the homomomorphism of rings $\varphi:A\to S^{-1}A$, we know $\varphi^{-1}(\overline{\wp})=\{a\in A|\frac{a}{1}\in\overline{\wp}\}\subseteq A$ is a prime ideal. Suppose to the contrary that $S\cap\wp\neq\emptyset$ then $1\in\overline{\wp}$ and $\overline{\wp}=S^{-1}A$ contradicting that $\overline{\wp}$ is prime in $S^{-1}A$. One can also see that $S^{-1}\wp=\{\frac{a}{s}|a\in\wp,s\in S\}=\overline{\wp}$ proving the bijective correspondence. 
\end{proof}
\begin{example}
  Let $S=A\setminus\wp$ for $\wp$ a prime ideal. We write $A_{\wp}=S^{-1}A$ the localization of $A$ away from $\wp$. The ideals of $A_{\wp}$ are exactly those primes contained in $\wp$ so $A_{\wp}$ has a unique maximal ideal, that is, $A_{\wp}$ is a local ring. 
\end{example}
Introducing some notation, let $I\subseteq A$ be an ideal. We denote $I_{\wp}\subseteq A_{\wp}$ the ideal in $A_{\wp}$ generated by $I$. We will soon prove some equivalent conditions for a Noetherian integral domain to be a Dedekind domain. To do so, we require the following lemma. 
\begin{lemma}\label{lem:intersection of prime ideals}
  Let $A$ be an integral domain. We have an equality $\cap_{\wp\text{ prime}}A_{\wp}=A$. 
\end{lemma}
\begin{proof}
  Let $x\in\cap_{\wp\text{ prime}}A_{\wp}$ and write $x=\frac{a}{b}$. Consider the ideal $\afrak\subseteq A$ by $\afrak=\{c\in A|ca\in(b)\subseteq A\}$ which can be thought of as the ideal of denominators of $x$. For every prime $\wp$, $\afrak\not\subseteq\wp$ as $x\in A_{\wp}$ but every proper ideal is contained in some maximal ideal so we have $\afrak=A$, showing that $x\in A$. 
\end{proof}
We can now show the following theorem that we will use to characterize Dedekind domains. 
\begin{theorem}\label{thm: dedekind TFAE}
  Let $A$ be a Noetherian integral domain. The following are equivalent:
  \begin{enumerate}[label=(\roman*)]
    \item For every nonzero prime ideal $\wp\subseteq A$, $A_{\wp}$ is a DVR. 
    \item $A$ is integrally closed and of Krull dimension at most 1. 
  \end{enumerate}
\end{theorem}
This is \cite[Ch. 1, \S 1, Prop. 4]{Serre}. 
\begin{proof}
  (i)$\Longrightarrow$(ii) Suppose $\wp\subseteq A$ is a prime ideal and $\mfrak$ the maximal ideal containing $\wp$. The local ring $A_{\mfrak}$ contains the prime ideal $\wp_{\mfrak}$ by \Cref{prop:localization correspondence}. Since $\mfrak$ is prime, $A_{\mfrak}$ is a DVR by assumption and given that the sole prime ideal in a DVR is $(\pi)$ for $\pi$ some uniformizer, we have either $\wp_{\mfrak}=(0)$ or $\wp_{\mfrak}=(\pi)$ showing that $A$ is of Krull dimension 1. To see that $A$ is integrally closed, note that for some $x\in K(A)$ be integral over $A$. We want to show that $x\in A$ but $x\in A_{\wp}$ for all primes $\wp$ so by \Cref{lem:intersection of prime ideals}, $x\in A$ showing that $A$ is integrally closed. 
  \\\\
  (ii)$\Longrightarrow$(i) Suppose that $A$ is integrally closed and of Krull dimension at most 1. Let $\wp\subseteq A$ be a nonzero prime ideal and consider the localization $S^{-1}A$ for $S=A\setminus\wp$. The ring $S^{-1}A$ has a unique nonzero prime ideal $S^{-1}\wp$. By \Cref{prop:DVR iff integrally closed and unique nonzero prime}, it suffices to show that $S^{-1}A$ is integrally closed. Let $x\in K(S^{-1}A)=K(A)$ be integral over $S^{-1}A$ so it satisfies
  \begin{align}\label{eqn: dedekind domain TFAE}
    x^{n}+b_{n-1}x+\dots+b_{1}x+b_{0} &= 0
  \end{align}
  for some $b_{i}\in S^{-1}A$. Writing each $b_{i}=\frac{a_{i}}{s_{i}}$ for $a_{i}\in A, s_{i}\in S$, we can take $s=\prod_{i=0}^{n-1}s_{i}$ and multiply (\ref{eqn: dedekind domain TFAE}) by $s^{n}$ to yield 
  \small
  \begin{align*}
    0 &= s^{n}x^{n}+a_{n-1}\left(s_{n-1}^{n-1}\prod_{0\leq i\leq n-2}s_{i}^{n}\right)x^{n-1}+\dots+a_{1}\left(s_{1}^{n-1}\prod_{0\leq i\leq n-1, i\neq 1}s_{i}^{n}\right)x+a_{0}\left(s_{0}^{n-1}\prod_{1\leq i\leq 0}s_{i}^{n}\right) \\
    &= (sn)^{n} + a_{n-1}\left(\prod_{0\leq i\leq n-2}s_{i}\right)(sx)^{n-1}+\dots+a_{1}\left(s_{1}^{n-2}\prod_{0\leq i\leq n-1, i\neq 1}s_{i}^{n-1}\right)(sx)+a_{0}\left(s_{0}^{n-1}\prod_{1\leq i\leq 0}s_{i}^{n}\right)
  \end{align*}
  \normalsize
  wherein $sx\in A$ and each 
  \small
  $$a_{n-1}\left(\prod_{0\leq i\leq n-2}s_{i}\right), \dots, a_{1}\left(s_{1}^{n-2}\prod_{0\leq i\leq n-1, i\neq 1}s_{i}^{n-1}\right), a_{0}\left(s_{0}^{n-1}\prod_{1\leq i\leq 0}s_{i}^{n}\right)\in A.$$
  \normalsize
  so by $A$ being integrally closed we conclude $sx\in A$ and thus $x\in S^{-1}A$ as desired. 
\end{proof}
We use these equivalent conditions to define a Dedekind domain. 
\begin{definition}[Dedekind Domain]
  A Dedekind domain is a Noetherian integral domain $A$ that satisfies any one of the equivalent conditions in \Cref{thm: dedekind TFAE}. 
\end{definition}
Some examples of Dedekind domains are as follows. 
\begin{example}
  $\ZZ, \Ocal_{K}$ for $K$ a number field, $\FF_{q}[t]$, and $\CC[t]$ are all Dedekind domains. 
\end{example}
\begin{example}
  Any PID is a Dedekind domain. Using the fact that PIDs are UFDs, one can yield a valuation by considering factorizations of the ideal generated by an element into prime ideals. 
\end{example}
One can also show that the property of being a Dedekind domain is preserved under localization. 
\begin{proposition}
  If $A$ is a Dedekind domain and $S$ a multiplicative subset of $A$, the localization $S^{-1}A$ is a Dedekind domain. 
\end{proposition}
\begin{proof}
  We show condition (b) in \Cref{thm: dedekind TFAE}. By hypothesis $A$ is a Dedekind domain so it is integrally closed and of Krull dimension at most 1. Since prime ideals of $S^{-1}A$ are those of $A$ not meeting $S$, $S^{-1}A$ is also of Krull dimension at most 1. One then applies the proof in the latter part of \Cref{thm: dedekind TFAE} to show integral closure. 
\end{proof}
Let $A$ be an integral domain and $K(A)$ its field of fractions. For $x\in K(A)$, we want to assign a valuation to $A$ with respect to some prime ideal $\wp$ of $A$. We make sense of this in terms of fractional ideals which provide a notion of multiplicative inverse for ideals. 
\begin{definition}[Fractional Ideal]
  Let $A$ be an integral domain with fraction field $K(A)$. A fractional ideal of $A$ is a finitely generated $A$-submodule of $K(A)$. 
\end{definition}
Given two $A$-submodules of $K(A)$, we can multiply them 
$$IJ=\left\{\sum_{i=1}^{n}a_{i}b_{i}|a_{i}\in I,b_{i}\in J\right\}.$$
\begin{definition}[Invertible]
  An ideal $I$ is invertible if there exists $J$ such that $IJ=A$. 
\end{definition}
In the case of Dedekind domainsm we can show that every ideal is invertible. This is a key part of the proof of the unique factorization property in Dedekind domains, and can in fact be used to define Dedekind domains themselves. 
\begin{proposition}[Dedekind Ideals are Invertible]
  Let $A$ be a Dedekind domain. Every nonzero fractional ideal is invertible. 
\end{proposition}
\begin{proof}
  Let $A$ be a Dedekind domain and $I\subseteq A$ a fractional ideal. Let $J=\{x\in K|xI\subseteq A\}$. We have $IJ\subseteq A$. Suppose to the contrary that $IJ\subsetneq A$. The ideal $IJ$ is contained in some maximal ideal $\mfrak$ so localizing at $\mfrak$ we have $J_{\mfrak}=\{x\in K|x I_{\mfrak}\in A_{\mfrak}\}$, that is, the inverse of $I_{\mfrak}$ as fractional ideals of $A_{\mfrak}$. In particular, observe $(IJ)_{\mfrak}=I_{\mfrak}J_{\mfrak}=A_{\mfrak}$, a contradiction as $IJ\subseteq\mfrak$. 
\end{proof}
We apply this to the factorization of ideals. 
\begin{theorem}[Factorization in Dedekind Domains]
  Let $A$ be a Dedekind domain. Every fractional ideal $I$ can be written uniquely as 
  $$I=\prod_{\wp_{i}\text{ prime}}\wp_{i}^{e_{i}}$$
  only finitely many $e_{i}$ nonzero. 
\end{theorem}
The proof of uniqueness was given in class. For existence, we adapt the proof from \cite[\S 3, Thm. 14]{Marcus}.
\begin{proof}
  (Existence) Suppose to the contrary that there is some collection of ideals not admitting a decomposition into prime dieals as above. Let $\qfrak$ be the maximal among such ideals not admitting a decomposition into primes where $\qfrak\neq A$ as $A$ is the empty product. Let $\pfrak$ be a prime ideal of $A$ containing $\qfrak$ and note that $\pfrak=\qfrak\afrak$ for some ideal $\afrak\subseteq A$ since $\qfrak\subseteq\pfrak$ implies $\pfrak|\qfrak$. But $\afrak$ contains $\qfrak$ so $\qfrak|\afrak$ and in fact $\qfrak\subsetneq\afrak$ as otherwise $\afrak=\qfrak$ and $\qfrak=\pfrak\qfrak$ implying $A=\pfrak$ a contradiction as $\pfrak$ was taken to be prime and hence proper. Using $\qfrak\subsetneq\afrak$ we have $\afrak$ is a product of primes and so is $\qfrak$, a contradiction. 
  \\\\
  (Uniqueness) Let $I\subseteq A$ be an ideal admitting a decomposition by 
  $$I=\prod_{\wp_{i}\text{ prime}}\wp_{i}^{e_{i}}.$$
  For each $\wp_{i}$, $I_{\wp_{i}}$ is an ideal in the DVR $A_{\wp_{i}}$ and $e_{i}=v_{\wp_{i}}(x)$ for $x$ a generator of $I_{\wp_{i}}$ in $A_{\wp_{i}}$.
\end{proof}
Returning to integrality, we prove the following statement that we will later use. 
\begin{proposition}\label{prop:integral over iff finite generation as a module}
  Let $A\subseteq B$ be rings. The elements $b_{1},\dots,b_{n}\in B$ are integral over $A$ if and only if $A[b_{1},\dots,b_{n}]$ is finitely generated as an $A$-module. 
\end{proposition}
Note that $A[b_{1},\dots,b_{n}]$ is finitely generated as an $A$-algebra, we are asking for something stronger. 
\begin{proof}
  $(\Longrightarrow)$ By induction, it suffices to show that if $b\in B$ is integral over $A$ the ring $A[b]$ is finitely generated as an $A$-module. Suppose $b\in B$ is integral over $A$ so 
  $$b^{n}+a_{n-1}b^{n-1}+\dots+a_{1}b+a_{0}=0$$
  for some $a_{0}, a_{1},\dots, a_{n-1}\in A$. Thus $A[b]$ is generated by $1, b, \dots,b^{n-1}$ as an $A$-module, that is, finitely generated as an $A$-module. 
  \\\\
  $(\Longleftarrow)$ Suppose $w_{1},\dots,w_{m}$ generate $A[b_{1},\dots,b_{n}]$ as an $A$-module. For $b\in A[b_{1},\dots,b_{n}]$ and any $w_{i}$ we can write 
  $$bw_{i}=\sum_{j=1}^{m}a_{ij}w_{j}$$
  with $a_{ij}\in A$. We use this $A$-linear expression to construct an integral dependence polynomial. Let 
  $$M=\begin{bmatrix}
    b-a_{11} & -a_{12} & \dots & -a_{1m} \\
    -a_{21} & b-a_{22} & \dots & a_{2m} \\
    \vdots & \vdots & \ddots & \vdots \\
    -a_{m1} & -a_{m2} & \dots & b-a_{mm}
  \end{bmatrix}.$$
  Observe that 
  $$M\begin{bmatrix}
    w_{1} \\ \vdots \\ w_{m}
  \end{bmatrix}=0_{m}$$
  so for $M^{*}$ the adjoint matrix satisfying $M^{*}M=\det M I_{m}$ we can consider the equation 
  $$M^{*}M\begin{bmatrix} w_{1}\\ \vdots\\ w_{m}\end{bmatrix}=\det M\begin{bmatrix}
    w_{1} \\ \vdots \\ w_{m}
  \end{bmatrix}=0_{m}$$
  as $1$ can be written as a linear cobmination of the $w_{i}$s. Thus $\det M$ is a monic in $A$ satisfied by $b\in A[b_{1},\dots,b_{n}]$ showing that $A[b_{1},\dots,b_{n}]$ is integral over $A$. 
\end{proof}